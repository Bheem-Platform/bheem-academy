import{r as u,d as x,a as b,o as F,c as g,b as p,e as M,f as o,w as y,g as v,h as w,v as S,n as _,t as f,i as G,j as U,k as B}from"./vue-DWqZH9f_.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const l of e)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(e){const l={};return e.integrity&&(l.integrity=e.integrity),e.referrerPolicy&&(l.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?l.credentials="include":e.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(e){if(e.ep)return;e.ep=!0;const l=r(e);fetch(e.href,l)}})();async function N(s){try{const n=await A();if(!n)return{success:!1,message:"Could not retrieve login token. Please refresh the page and try again."};const r=document.createElement("form");r.method="POST",r.action="/login/index.php",r.style.display="none";const i={username:s.username.toLowerCase().trim(),password:s.password,rememberusername:s.rememberMe?"1":"0",logintoken:n,anchor:location.hash};return Object.entries(i).forEach(([e,l])=>{const a=document.createElement("input");a.type="hidden",a.name=e,a.value=l,r.appendChild(a)}),document.body.appendChild(r),r.submit(),{success:!0,message:"Logging in..."}}catch(n){return console.error("Login error:",n),{success:!1,message:n.message||"An error occurred during login. Please try again."}}}async function T(){try{const s=await A();if(!s)return{success:!1,message:"Could not retrieve login token. Please refresh the page and try again."};const n=document.createElement("form");return n.method="POST",n.action="/login/index.php",n.style.display="none",Object.entries({username:"guest",password:"guest",logintoken:s}).forEach(([i,e])=>{const l=document.createElement("input");l.type="hidden",l.name=i,l.value=e,n.appendChild(l)}),document.body.appendChild(n),n.submit(),{success:!0,message:"Logging in as guest..."}}catch(s){return console.error("Guest login error:",s),{success:!1,message:"An error occurred during guest login."}}}async function A(){try{const s=await fetch("/login/index.php?traditional=1",{method:"GET",credentials:"same-origin",headers:{Accept:"text/html"}});if(!s.ok)return console.error("Failed to fetch login page:",s.status),"";const r=(await s.text()).match(/name="logintoken"\s+value="([^"]+)"/);return r&&r[1]?(console.log("Login token retrieved successfully"),r[1]):(console.warn("Login token not found in response"),"")}catch(s){return console.error("Error getting login token:",s),""}}function I(){const s=u(!1),n=u(null),r=u(null);return{isAuthenticated:s,user:n,error:r,login:async a=>{r.value=null;try{const d=await N(a);if(!d.success)throw new Error(d.message||"Login failed");s.value=!0}catch(d){throw r.value=d.message||"An error occurred during login",d}},loginAsGuest:async()=>{r.value=null;try{const a=await T();if(!a.success)throw new Error(a.message||"Guest login failed");return a}catch(a){throw r.value=a.message||"An error occurred during guest login",a}},logout:()=>{s.value=!1,n.value=null,window.location.href="/login/logout.php"}}}function L(s){return!s||s.trim()===""?"Username is required":s.length<2?"Username must be at least 2 characters":s.length>100?"Username is too long":""}function k(s){return!s||s===""||s.length<1?"Password is required":""}const D={class:"login-page-exact"},V={class:"login-area"},q={class:"container"},$={class:"row"},j={class:"col-12"},z={class:"login-wrapper pt-100 pb-75"},K={class:"login-container"},H={class:"loginform"},J={class:"login-form-username mb-3"},Q={key:0,class:"invalid-feedback"},R={class:"login-form-password mb-3"},W=["type"],X={key:0,class:"invalid-feedback"},Y={key:0,class:"alert alert-danger",role:"alert"},Z={class:"login-form-submit mb-3"},ee=["disabled"],se=["disabled"],oe=x({__name:"LoginPage",setup(s){const{login:n,loginAsGuest:r}=I(),i=b({username:"",password:"",rememberMe:!1}),e=b({username:"",password:""}),l=u(!1),a=u(!1),d=u("");F(()=>{const c=document.getElementById("anchor");c&&(c.value=location.hash)});const h=c=>{c==="username"?e.username=L(i.username):c==="password"&&(e.password=k(i.password))},P=()=>(e.username=L(i.username),e.password=k(i.password),!e.username&&!e.password),C=async()=>{if(d.value="",!!P()){a.value=!0;try{await n({username:i.username,password:i.password,rememberMe:i.rememberMe})}catch(c){d.value=c.message||"Invalid login credentials. Please try again."}finally{a.value=!1}}},E=async()=>{a.value=!0,d.value="";try{await r()}catch(c){d.value=c.message||"Guest login is not available."}finally{a.value=!1}},O=()=>{alert("Cookies notice: This site uses cookies to ensure you get the best experience on our website.")};return(c,t)=>(p(),g("div",D,[t[12]||(t[12]=M('<div class="page-banner-area bg-secondary py-60 position-relative z-1 overflow-hidden" data-v-b7648e92><div class="container" data-v-b7648e92><div class="row align-items-center" data-v-b7648e92><div class="col-lg-6 col-sm-6" data-v-b7648e92><div class="page-banner-content text-sm-start text-center mb-4 mb-sm-0" data-v-b7648e92><h2 class="fs-2 text-white mb-md-3 mb-1" data-v-b7648e92>Log in to the site</h2></div></div></div></div></div>',1)),o("div",V,[o("div",q,[o("div",$,[o("div",j,[o("div",z,[o("div",K,[o("div",H,[t[8]||(t[8]=o("div",{id:"loginlogo",class:"login-logo"},[o("img",{id:"logoimage",src:"https://dev.bheem.cloud/pluginfile.php?file=%2F1%2Fcore_admin%2Flogo%2F0x200%2F-1%2Flogo.png",class:"img-fluid",alt:"Bheem Academy : : AI-Driven Learning for a Smarter"}),o("h1",{class:"login-heading visually-hidden"}," Log in to Bheem Academy : : AI-Driven Learning for a Smarter ")],-1)),o("form",{class:"login-form",onSubmit:y(C,["prevent"]),method:"post",id:"login",novalidate:""},[t[6]||(t[6]=o("input",{id:"anchor",type:"hidden",name:"anchor",value:""},null,-1)),o("div",J,[t[4]||(t[4]=o("label",{for:"username",class:"visually-hidden"},"Username",-1)),w(o("input",{type:"text",name:"username",id:"username","onUpdate:modelValue":t[0]||(t[0]=m=>i.username=m),class:_(["form-control form-control-lg",{"is-invalid":e.username}]),placeholder:"Username",autocomplete:"username",onBlur:t[1]||(t[1]=m=>h("username"))},null,34),[[S,i.username]]),e.username?(p(),g("div",Q,f(e.username),1)):v("",!0)]),o("div",R,[t[5]||(t[5]=o("label",{for:"password",class:"visually-hidden"},"Password",-1)),w(o("input",{type:l.value?"text":"password",name:"password",id:"password","onUpdate:modelValue":t[2]||(t[2]=m=>i.password=m),class:_(["form-control form-control-lg",{"is-invalid":e.password}]),placeholder:"Password",autocomplete:"current-password",onBlur:t[3]||(t[3]=m=>h("password"))},null,42,W),[[G,i.password]]),e.password?(p(),g("div",X,f(e.password),1)):v("",!0)]),d.value?(p(),g("div",Y,f(d.value),1)):v("",!0),o("div",Z,[o("button",{class:"btn btn-primary btn-lg",type:"submit",id:"loginbtn",disabled:a.value},f(a.value?"Logging in...":"Log in"),9,ee)]),t[7]||(t[7]=o("div",{class:"login-form-forgotpassword mb-3"},[o("a",{href:"/login/forgot_password.php"},"Lost password?")],-1))],32),t[9]||(t[9]=o("div",{class:"login-divider"},null,-1)),t[10]||(t[10]=o("h2",{class:"login-heading"},"Some courses may allow guest access",-1)),o("form",{onSubmit:y(E,["prevent"]),id:"guestlogin"},[o("button",{class:"btn btn-secondary",type:"submit",id:"loginguestbtn",disabled:a.value}," Access as a guest ",8,se)],32),t[11]||(t[11]=o("div",{class:"login-divider"},null,-1)),o("div",{class:"d-flex"},[o("button",{type:"button",class:"btn btn-secondary",onClick:O}," Cookies notice ")])])])])])])])])]))}}),te=(s,n)=>{const r=s.__vccOpts||s;for(const[i,e]of n)r[i]=e;return r},ne=te(oe,[["__scopeId","data-v-b7648e92"]]),re={id:"app",class:"app-container"},ae=x({__name:"App",setup(s){return(n,r)=>(p(),g("div",re,[U(ne)]))}}),ie=B(ae);ie.mount("#app");
//# sourceMappingURL=index-Dgqy9xMK.js.map
