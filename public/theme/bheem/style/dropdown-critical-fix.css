/* ================================================
   CRITICAL DROPDOWN FIX - FORCE VISIBILITY
   Overrides all conflicting styles
   ================================================ */

/* ================================================
   RESET ALL DROPDOWN HIDING
   ================================================ */
.navbar .dropdown-menu {
  /* Remove all transforms and transitions temporarily */
  transform: none !important;
  transition: none !important;

  /* Ensure menu exists in DOM */
  display: none !important; /* Start hidden */
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
}

/* ================================================
   DROPDOWN HOVER TRIGGER - IMMEDIATE SHOW
   ================================================ */
.navbar .dropdown:hover > .dropdown-menu,
.navbar .nav-item.dropdown:hover > .dropdown-menu,
.navbar-nav .dropdown:hover > .dropdown-menu,
.navbar .nav-item:hover > .dropdown-menu {
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
  transform: translateY(0) !important;
}

/* ================================================
   DROPDOWN CLICK/SHOW STATE
   ================================================ */
.navbar .dropdown.show > .dropdown-menu,
.navbar .nav-item.dropdown.show > .dropdown-menu,
.navbar .dropdown-menu.show,
.navbar .dropdown.open > .dropdown-menu {
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
}

/* ================================================
   DROPDOWN MENU POSITIONING - ABSOLUTE
   ================================================ */
.navbar .dropdown {
  position: relative !important;
}

.navbar .dropdown-menu {
  position: absolute !important;
  top: 100% !important;
  left: 0 !important;
  right: auto !important;
  margin-top: 2px !important;
  z-index: 1010 !important; /* Fixed: Using proper dropdown z-index (was 9999) */
}

/* ================================================
   DROPDOWN MENU STYLING - HIGH CONTRAST
   ================================================ */
.navbar .dropdown-menu {
  /* Strong white background */
  background: #ffffff !important;
  background-color: #ffffff !important;

  /* Clear borders and shadows */
  border: 2px solid #e5e7eb !important;
  border-radius: 12px !important;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15),
              0 4px 6px rgba(0, 0, 0, 0.1) !important;

  /* Padding and sizing */
  padding: 8px !important;
  min-width: 220px !important;
  max-width: 300px !important;
}

/* ================================================
   DROPDOWN ITEMS - VISIBLE STYLING
   ================================================ */
.navbar .dropdown-item {
  display: block !important;
  width: 100% !important;
  padding: 10px 16px !important;
  clear: both !important;
  font-weight: 500 !important;
  color: #1f2937 !important;
  text-align: left !important;
  text-decoration: none !important;
  white-space: nowrap !important;
  background-color: transparent !important;
  border: 0 !important;
  border-radius: 8px !important;
  margin: 2px 0 !important;
  transition: all 0.2s ease !important;
}

.navbar .dropdown-item:hover,
.navbar .dropdown-item:focus {
  color: #7c3aed !important;
  text-decoration: none !important;
  background-color: #f3f4f6 !important;
}

.navbar .dropdown-item.active,
.navbar .dropdown-item:active {
  color: #fff !important;
  text-decoration: none !important;
  background-color: #7c3aed !important;
}

/* ================================================
   CONTAINER OVERFLOW FIXES
   ================================================ */
.navbar,
.navbar .container,
.navbar .container-fluid,
.navbar-collapse,
nav.navbar {
  overflow: visible !important;
  position: relative !important;
}

/* ================================================
   JAVASCRIPT HELPER CLASSES
   ================================================ */
/* For JavaScript control */
.dropdown-menu.force-show {
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
}

/* ================================================
   BOOTSTRAP 4/5 COMPATIBILITY
   ================================================ */
/* Bootstrap 4 */
.navbar .dropdown-menu.show {
  display: block !important;
}

/* Bootstrap 5 */
.navbar .dropdown-menu[data-bs-popper] {
  position: absolute !important;
  top: 100% !important;
  left: 0 !important;
  z-index: 1000 !important;
  display: none !important;
  min-width: 10rem !important;
  padding: 0.5rem 0 !important;
  margin: 0 !important;
}

.navbar .dropdown.show .dropdown-menu[data-bs-popper] {
  display: block !important;
}

/* ================================================
   MOODLE SPECIFIC FIXES
   ================================================ */
/* Moodle nav drawer fix */
.navbar .nav-drawer {
  z-index: 200 !important; /* Fixed: Using proper drawer z-index (was 999) */
}

/* Moodle popover region */
.navbar .popover-region .popover-region-container {
  position: absolute !important;
  top: 100% !important;
  right: 0 !important;
  z-index: 1060 !important; /* Fixed: Using proper popover z-index (was 9999) */
}

/* ================================================
   MOBILE RESPONSIVE FIXES
   ================================================ */
@media (max-width: 991px) {
  .navbar .dropdown-menu {
    position: static !important;
    float: none !important;
    width: 100% !important;
    margin-top: 0 !important;
    background-color: #ffffff !important;
    border: 0 !important;
    box-shadow: none !important;
  }

  /* Mobile: Only show on click, not hover */
  .navbar .dropdown:hover > .dropdown-menu {
    display: none !important;
  }

  .navbar .dropdown.show > .dropdown-menu {
    display: block !important;
  }
}

/* ================================================
   Z-INDEX HIERARCHY - MAXIMUM PRIORITY
   ================================================ */
.navbar {
  z-index: 1030 !important;
}

.navbar .dropdown {
  z-index: 1031 !important;
}

.navbar .dropdown-menu {
  z-index: 1010 !important; /* Fixed: Using proper dropdown z-index (was 99999) */
}

/* ================================================
   DEBUG MODE - FORCE VISIBILITY
   ================================================ */
/* Uncomment to force dropdowns visible for debugging */
/*
.navbar .dropdown-menu {
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
  background: yellow !important;
  border: 2px solid red !important;
}
*/

/* ================================================
   FINAL OVERRIDE - ABSOLUTE HIGHEST PRIORITY
   ================================================ */
body .navbar .dropdown:hover > .dropdown-menu,
body .navbar .nav-item.dropdown:hover > .dropdown-menu,
#page .navbar .dropdown:hover > .dropdown-menu,
#page .navbar .nav-item.dropdown:hover > .dropdown-menu {
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
  position: absolute !important;
  top: 100% !important;
  z-index: 1010 !important; /* Fixed: Using proper dropdown z-index (was 99999) */
}

/* Alternative method using important on all properties */
.navbar .dropdown-menu.showing,
.navbar .dropdown:hover .dropdown-menu {
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
  transform: none !important;
  pointer-events: auto !important;
}